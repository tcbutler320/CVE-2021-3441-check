# HP CVE Check  
> A python threat intelligence tool for automating IoC discovery for CVE  
```
                                            ________________
                                        _/_______________/|
                                        /___________/___//||    HP CVE Check
                                        |===        |----| || 
                                        |           |   �| ||    Author: Tyler Butler 
                                        |___________|   �| ||            @tbutler0x90
                                        | ||/.�---.||    | ||    
                                        |-||/_____\||-.  | |�
                                        |_||==HP===||_|__|/      
```  


## About 
HP CVE Check is a python tool to search targets for indicators of compromise to CVE. The script gets product versions from the target's http response header. If the product version is vulnerable, and a module for the version has been created, the script requests the resource that could contain an exploit payload. Once the html entity that could contain an exploit is loaded, common XSS characters are searched for. The program alerts the user through the console if exploit payloads are found and can log findings to an output file.
## Use  

1) Check a target for indicators of compromise  

```python
python3 hp-cve-check.py -i [target ip] -O ./test/output.txt
```

```bash
➜  hp-cve-check git:(master) ✗ python3 hp-cve-check.py -i 192.168.223.1 -O ./test/output.txt
{!} Starting hp-cve-search.... 
    ..... Author: Tyler Butler
    ..... @tbutler0x90
{!} Testing target:  192.168.223.1
    ----------------------------------------
{!} -------- {INFO} Printer Version Detected
{!} -------- {INFO} Product Version is Supported
{!} -------- {INFO} Requesting  http://192.168.223.1/DevMgmt/ProductConfigDyn.xml
{!} -------- {INFO}: OK Response, Status Code: 200
{!} -------- {INFO}: Found Something in DeviceLocation Field
{!} -------- {INFO}: Checking for Suspicious characters
{!} -------- {WARNING}: Found Indicator of Compromise
{!} -------- {WARNING}: Payload=<dd:devicelocation>&lt;script&gt;alert('XSS');&lt;/script&gt;</dd:devicelocation>
```  


1) Check a target list for indicators of compromise   
```python
python3 hp-cve-check.py -i [target list] -o [output file]
```  

## Options 

|  Option 	|  Description 	|  Use 	|
|---	|---	|---	|
|  -i 	|  target ip 	|  `-i 192.168.223.1` 	|
|  -I 	|  target file 	|  `-i targets.txt` 	|
|  -O 	|  output file 	|  `-O output.txt` 	|

## Output Format  
IF IoC's are found they are logged to the output file in a greppable format, `[target ip]:[payload]`  

```
➜  hp-cve-check git:(master) ✗ cat ./test/output.txt                                        
192.168.223.1:<script>alert('XSS');</script>
```  

## Modules  
Because indicators of compromise are found in different resources depending on the product version, `modules` are used to store version specific configuration options. Modules are stored in the `modules ` folder in yaml format. One module yml file is created for each supported version and contains the following options,  

+ product
+ path
+ tag

**hp-officejet-4630.yml module**
```yml
---
product: "HP Officejet 4630"
path: '/DevMgmt/ProductConfigDyn.xml' 
tag: 'dd:deviceLocation'
```

## Packages   
HP CVE Check is broken down into the `core` and `util` packages. 

**HP CVE Check Packages**
```
➜  hp-cve-check git:(master) ✗ tree 
├── lib
│   ├── core         
│   │   ├── constants.py
│   │   ├── iocCheck.py
│   │   ├── module_parser.py
│   │   ├── printer.py
│   │   └── requests.py
│   └── utils
│       └── help.py
├── modules
│   └── hp-officejet-4630.yml
```